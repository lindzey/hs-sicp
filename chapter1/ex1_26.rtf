{\rtf1\ansi\ansicpg1252\cocoartf1187\cocoasubrtf370
{\fonttbl\f0\fswiss\fcharset0 Helvetica;}
{\colortbl;\red255\green255\blue255;}
\margl1440\margr1440\vieww10800\viewh8400\viewkind0
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural

\f0\fs24 \cf0 The args to (* n n) are each evaluated, whereas (square n) evaluates n and then calls (* n n) on it. Thus, for more complicated arguments, square is clearly faster. \
\
In this case, the original is log(n) because at expmod is called once for every time you can divide the input exponent by 2. The new case winds up calling expmod exp times. }